 const csvData = `Title 
 When I try to reset my Saba password "XO" it doesn’t work. (For learners)
 I already completed an Essential Training Curriculum (ETC) course at a previous department. Do I need to take the course again at ESDC? (For learners)
 How can I ensure that the Essential Training Curriculum (ETC) courses I am directed to take through Canada School of Public Service (CSPS) are included in my Saba profile? (For learners)
 How quickly will my Saba profile be updated with my completion results once I complete an Essential Training Curriculum (ETC) course on the Canada School of Public Service (CSPS) Learning Platform? (For learners)
 I completed an Essential Training Curriculum (ETC) course in the Canada School of Public Service (CSPS) Learning Platform more than a week ago"XO" yet it is not showing up in my Saba learning history as complete. What do I do? (For learners)
 What should I do if I need an alternate (Alt) version of an Essential Training Curriculum (ETC) course? (For learners)
 What should I do if I encounter technical difficulties with Saba? (For learners)
 I cannot find my manager or team leader in Saba. (For learners)
 I need manager access (for managers/team leaders) in Saba. (For managers)
 How long will my Saba session remain active before it automatically disconnects due to inactivity?
 I’m a new manager/team leader. How can I add my team members to my Saba account? (For managers)
 How do I get course content uploaded to Saba? (For administrators – job aid)
 How do I get the content uploader role in Saba? (For administrators)
 How do I get my Canada School of Public Service (CSPS) completion data transferred to my Essential Training Curriculum (ETC) or my mandatory training on Saba? (For learners)
 One of my employees has exhausted all their attempts at passing a test. How do I add an attempt? (For managers)
 I have exhausted all attempts at passing a test. How can I obtain another attempt? (For learners)
 How do I make sure my Reconciliation learning is accurately captured in my Saba learning history? (For learners)
 What is my Saba username?
 Are there several ways to find courses I can register to in Saba?
 What should I do if my course is not marking complete?  Something is preventing me from continuing my course or launching the test. (For learners)
 What should I do if I encounter technical difficulties while trying to access or complete a Canada School of Public Service (CSPS) course? (For learners)
 How do I access my team’s Essential Training Curriculum (ETC) completion data? (For managers)
 As a manager (or team leader)"XO" what should I do to ensure that my Saba reports are accurate? (For managers)
 How can I share a Saba link to a class or a course with another learner? (For learners)
 How can I share the link to a class with my team? (For managers)
 Where can I find the link for a course"XO" a class"XO" curriculum or certification?  How can I guide learners to my training? (For administrators)
 Why isn’t my Essential Training Curriculum (ETC) for managers automatically added to my profile? (For learners)
 I need to correct errors in my personal information"XO" such as my name and/or my email address. (For learners)
 I have returned from an absence; how do I get my Saba account reactivated? (For learners)
 What happens to a Saba account when an employee leaves the Department"XO" or retires"XO" but then returns to the department?  I cannot access my Saba account. (For learners)
 I want to bookmark the link to Saba. Which link should I use? (For learners)
 How do I switch the language of my class? (For learners)
 What should I do if my manager (or team leader) does not see my approval request? (For learners)
 What should I do if I do not see my employee’s approval request? (For managers)
 How long can I be inactive in Saba before I am automatically logged out of Saba? (For learners)
 As a manager (or team leader)"XO" how do I add or remove employees from My Team? (For managers)
 What training do I need to complete? (For learners)
 Can I log into Saba off the government network/ from my home computer? (For learners)
 Why is there an evaluation pending for a course that I have completed? (For learners)
 How can I approve my team’s learning? (For managers)
 Does Saba have an iService page?
 How do I become a course administrator or instructor?
 Where can I find information on the ESDC Essential Training Curricula (ETC)?
 Where can I find the managers’ (or team leaders’) job aids? (For managers – job aid)
 How can I access my team’s essential training curriculum (ETC) completion data? (For managers – job aid)
 Can I assign a proxy to complete actions on my behalf on Saba? (For managers – job aid)
 How can I act as a proxy for an executive? (For managers – job aid)
 How can I add a learning activity to a team member’s plan? (For managers – job aid)
 Where can I find all the Learner job aids? (For learners – job aid)
 How can I accept a waitlisted seat? (For learners – job aid)
 How can I access my Saba account for the first time? (For learners – job aid)
 How can I activate accessibility mode? (For learners – job aid)
 How can I add a course / external learning to my completed learning if I did not take it on Saba (Excluding courses from the Essential Training Curriculums [ETC])? (For learners – job aid)
 How can I change my language preference? (For learners – job aid)
 How can I change my password? (For learners – job aid)
 How can I drop a class? (For learners – job aid)
 How do I navigate within Saba? (For learners – job aid)
 How can I print or export a certificate of achievement? (For learners – job aid)
 How can I reset my password? (For learners – job aid)
 How do I search Saba’s learning catalogue? (For learners – job aid)
 How do I update my manager (or team leader) in Saba? (For learners – job aid)
 How do I view a class attachment? (For learners – job aid)
 How can I relaunch content from a course that I previously completed? (For learners – job aid)
 Where can I find all the administrator job aids that are linked here? (For administrators – job aid)
 How do I add a facilitator to a class? (For administrators – job aid)
 How do I add an evaluation to a class? (For administrators – job aid)
 How do I add attachments to a class? (For administrators – job aid)
 How do I create a blended class? (For administrators – job aid)
 How do I create a virtual class? (For administrators – job aid)
 How do I create a Web-based class? (For administrators – job aid)
 How do I create an instructor-led class? (For administrators – job aid)
 How do I attach content to a Web-based or blended class? (For administrators – job aid)
 How do I add a learner to a class through the roster? (For administrators – job aid)
 How do I assign a learning activity to a learner using the registrar desktop? (For administrators – job aid)
 How do I cancel a class? (For administrators – job aid)
 How do I modify a registration? (For administrators – job aid)
 How do I record a learner’s status in a class? (For administrators – job aid)
 How do I close a class? (For administrators – job aid)
 How do I reschedule a class? (For administrators – job aid)
 How do I search for a class and find its roster? (For administrators – job aid)
 I can't find certain administrators job aids. (For administrators – job aid)
 How can I upload to Saba Development? (For Content Administrators – job aid)
 How can I upload to Saba Production? (For Content Administrators – job aid)
 How can I publish courses created on Adapt? (For Content Administrators – job aid)
 How can I create and Manage Scheduled Reports? (For administrators – job aid)
 How can I view and Export Reports? (For administrators – job aid)
 How can I search for a course? (For administrators – job aid)
 How can I add an owner to a course? (For administrators – job aid)
Why was my status marked as "unsuccessful or successful" if I didn't attend a virtual or instructor-led class?
How can I cancel a class? (For instructors – job aid)
How can I add learners to a class? (For instructors – job aid)
How can I close a class? (For instructors – job aid)
How can I find a class roster? (For instructors – job aid)
How can I record attendance and learner results? (For instructors – job aid)
How can I navigate in Saba as an Instructor? (For instructors – job aid)
How can I use private class attachments? (For instructors – job aid)
How can I discontinue a course? (For administrators – job aid)
How can I internationalize a course? (For administrators – job aid)
How can I internationalize a class? (For administrators – job aid)
How can I add prerequisites to a course? (For administrators – job aid)
How can I add Delivery Types to a Course? (For administrators – job aid)
How can I add a Completed Course? (For learners – job aid)
How can I view the content of a course without registering to a class? (For Content Viewer role - Job aid)`
 
 

// Initialize variables to hold the Title and Keywords values
var titles = [];

// Function to parse the CSV data and extract Title and Keywords values
function parseCSV() {
    return new Promise((resolve, reject) => {
        Papa.parse(csvData, {
            header: true,
            quoteChar: '"',
            skipEmptyLines: true,                      
            complete: (results) => {
                titles = results.data.map(row => 
                    row['Title '].replace(/^""|""$/g, '"') 
                      // Convert "" to a single "
                    .trim()                 // Trim leading/trailing spaces
                    .replace(/\s+/g, ' ')
                    .replace(/"XO"/g, ',')
                );

                // console.log('English Questions',titles);    // Optional: Log titles for verification
                  // Remove the last empty element if present
                  if (titles[titles.length - 1] === "") {
                    titles.pop();
                }


                resolve({ titles}); // Resolve with the arrays
            },
            error: (error) => reject(error)
        });
    });
}

function getTitles() {
    return titles;
}


parseCSV().then(() => {
    console.log("CSV Parsed and titles and keywords ready for export");
});

// Expose the functions to the window object for global access
window.getTitles = getTitles;
